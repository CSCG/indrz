{% extends "wu-neu-base.html" %}
{% load staticfiles %}
{% load i18n %}

{% block head_extra %}
    <script src="{% static "js/bootstrap.min.js" %}"></script>

    <link rel="stylesheet" href="{% static "css/ol3-17.1.css" %}" type="text/css">
    <link rel="stylesheet" href="{% static "css/custom-layout.css" %}" type="text/css">
    <link rel="stylesheet" href="{% static "css/indrz-layout.css" %}" type="text/css">

    <script src="{% static "js/ol3.17.1.js" %}"></script>
    <script type="text/javascript" src="{% static "wu-neu/app.min.js" %}"></script>
    <script src="{% static "js/bloodhound.min.js" %}"></script>
    <script src="{% static "js/typeahead.bundle.min.js" %}"></script>
{#    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">#}

    <style> body {
        padding-top: 0px;
    }</style>

{% endblock head_extra %}


{% block left-content %}
            <div class="col-md-3 col-lg-2" id="map-search-form">
                    <h3>{% trans 'Search on campus' %}</h3>
                    <p></p>
                    <div id="search-prefetch2" class="input-group">
                        {% block search_form %}{% include 'search-form.html' %}{% endblock search_form %}
                    </div>
            <p>

            </p>

                    <div >
                        {% block routing-form %} {% include 'routing-form.html' %} {% endblock routing-form %}
                    </div>

                    <div >
                        {% include "includes/change_lang_form.html" %}
                    </div>



            </div>

{% endblock left-content %}



{% block right-content-map %}


{#    <div class="embed-responsive embed-responsive-16by9">#}
{##}
{#        <iframe src="http://localhost:8000/map/test" class="embed-responsive-item" style="border: 0; width: 100%; height: 700px;" seamless></iframe>#}
{##}
{#    </div>#}

{% endblock right-content-map %}


{% block content %}{% endblock content %}


{% block js-search-box %}
<script>  {% include 'homepage/indrzMapConf.js' %} </script>
    <script>

       var building_id = 1;

        var searchValues = new Bloodhound({
            datumTokenizer: Bloodhound.tokenizers.whitespace,
            queryTokenizer: Bloodhound.tokenizers.whitespace,
            // prefetch: baseApiUrl + 'spaces/search/?format=json',
            prefetch: 'http://localhost:8000/autocomplete/%QUERY?.format=json',
            remote: {
              url: 'http://localhost:8000/autocomplete/%QUERY?.format=json',
              wildcard: '%QUERY'
            }
        });

        // passing in `null` for the `options` arguments will result in the default
        // options being used
        $('#search-input').typeahead(null, {
            hint: true,
            highlight: true,
            minLength: 1,
            name: 'search-field',
            limit: 100,
            source: searchValues
        });


        $("#submitFormSearch").submit(function (event) {
            {#              alert( "Handler for .submit() called."  );#}

            {#            var buildingid = buildingNantesId;#}
            var searchText = $('#search-input').val();
            searchIndrz(building_id, searchText);
            event.preventDefault();
        });
    </script>


{% endblock js-search-box %}

{% block route_from_to %}
    <script>
    // http://tatiyants.com/how-to-use-json-objects-with-twitter-bootstrap-typeahead/
        var roomNums = new Bloodhound({
            datumTokenizer: Bloodhound.tokenizers.whitespace,
            queryTokenizer: Bloodhound.tokenizers.whitespace,
            prefetch: baseApiUrl + 'spaces/search/?format=json'
        });
        // passing in `null` for the `options` arguments will result in the default
        // options being used
        $('#rooms-prefetch .typeahead').typeahead(null, {
            name: 'countries',
            limit: 100,
            source: roomNums
        });
        $("#submitForm").submit(function (event) {
            {#  alert( "Handler for .submit() called."  );#}
            var startNum = $('#route-from').val();
            var endNum = $('#route-to').val();
            var rType = $("input:radio[name=typeRoute]:checked").val();
            addRoute(startNum, endNum, rType);
            event.preventDefault();
        });
    </script>

{% endblock route_from_to %}



{% block map_frame %}
    <script>  {% include 'homepage/bugreport.js' %} </script>
    <script>  {% include 'homepage/indrzLayers.js' %} </script>
    <script>  {% include 'homepage/indrz-floorswitcher.js' %} </script>
    <script>  {% include 'homepage/indrzMapInit.js' %}</script>
    <script>  {% include 'homepage/routing.js' %} </script>
    <script>  {% include 'homepage/search.js' %} </script>
    <script>  {% include 'homepage/indrz-popup.js' %} </script>
    <script>  {% include 'homepage/indrz-controls.js' %} </script>
    <script>  {% include 'homepage/indrz_live_url_update.js' %} </script>
    <script>  {% include 'homepage/share.js' %} </script>
    <script>  {% include 'homepage/initialize.js' %} </script>
    {% if space_id > 0 and space_id != None %}
        <script>  {% include 'homepage/indrz-space.js' %} </script>
    {% endif %}
{% endblock map_frame %}
